% Prolog programs can be called from LPS.

maxTime(3).
events	request(_).
actions	announce(_).

observe  request(sort([2,1,4,3])) from 0 to 1.


if	request(sort(X)) from T1 to T2 
then	quicksort(X, Y), announce(sorted(Y)) from T2 to T3.

quicksort([X|Xs],Ys) :-
  	partition(Xs,X,Left,Right),
  	quicksort(Left,Ls),
  	quicksort(Right,Rs),
  	basics:append(Ls,[X|Rs],Ys). % for XSB use instead basics:append(Ls,[X|Rs],Ys)

quicksort([],[]).


partition([X|Xs],Y,[X|Ls],Rs) :-
  	X =< Y, partition(Xs,Y,Ls,Rs).

partition([X|Xs],Y,Ls,[X|Rs]) :-
  	X > Y, partition(Xs,Y,Ls,Rs).

partition([],Y,[],[]).

% The following complication stems from a desire to execute the test suite both on SWI and XSB Prolog
% If on SWI, you could simply use append rather than my_append:
my_append(A,B,C) :- current_prolog_flag(dialect, xsb), !, basics:append(A,B,C).
my_append(A,B,C) :- append(A,B,C).